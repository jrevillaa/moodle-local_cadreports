{"version":3,"file":"form_multiselect.min.js","sources":["../src/form_multiselect.js"],"sourcesContent":["/**\n * JavaScript simple para multiselect de cursos y grupos\n * Plugin local_cadreports para Moodle 4.4\n */\n\ndefine(['jquery', 'core/ajax', 'core/notification'], function($, Ajax, Notification) {\n\n    var FormMultiselect = {\n\n        /**\n         * Inicializar multiselect\n         */\n        init: function() {\n            var courseSelect = $('#id_courseids');\n            var groupSelect = $('#id_groupids');\n\n            // Cuando cambian los cursos seleccionados, actualizar grupos\n            courseSelect.on('change', function() {\n                FormMultiselect.updateGroups(courseSelect.val(), groupSelect);\n            });\n\n            // Mejorar apariencia de selects múltiples\n            FormMultiselect.enhanceMultiselects();\n        },\n\n        /**\n         * Actualizar grupos basado en cursos seleccionados\n         * @param {Array} selectedCourses Array de IDs de cursos seleccionados\n         * @param {jQuery} groupSelect Elemento jQuery del select de grupos\n         */\n        updateGroups: function(selectedCourses, groupSelect) {\n            // Limpiar grupos actuales\n            groupSelect.empty();\n\n            if (!selectedCourses || selectedCourses.length === 0) {\n                groupSelect.append('<option value=\"\">' +\n                    'Selecciona primero uno o más cursos' + '</option>');\n                return;\n            }\n\n            // Cargar grupos para los cursos seleccionados\n            Ajax.call([{\n                methodname: 'local_cadreports_get_groups_for_courses',\n                args: {courseids: selectedCourses.map(function(id) { return parseInt(id); })},\n                done: function(groups) {\n                    if (groups.length === 0) {\n                        groupSelect.append('<option value=\"\">' +\n                            'No hay grupos para los cursos seleccionados' + '</option>');\n                    } else {\n                        $.each(groups, function(index, group) {\n                            groupSelect.append('<option value=\"' + group.id + '\">' +\n                                group.name + ' (' + group.coursename + ')</option>');\n                        });\n                    }\n                },\n                fail: function(error) {\n                    Notification.exception(error);\n                    groupSelect.append('<option value=\"\">' +\n                        'Error cargando grupos' + '</option>');\n                }\n            }]);\n        },\n\n        /**\n         * Mejorar apariencia de selects múltiples\n         */\n        enhanceMultiselects: function() {\n            // Agregar CSS personalizado para hacer los selects más usables\n            $('<style>')\n                .prop('type', 'text/css')\n                .html(`\n                    .cadreports-multiselect {\n                        min-height: 120px !important;\n                        font-size: 14px;\n                    }\n                    .cadreports-multiselect option {\n                        padding: 4px 8px;\n                    }\n                    .cadreports-multiselect option:hover {\n                        background-color: #e3f2fd;\n                    }\n                `)\n                .appendTo('head');\n\n            $('#id_courseids, #id_groupids').addClass('cadreports-multiselect');\n        }\n    };\n\n    return FormMultiselect;\n});\n"],"names":["define","$","Ajax","Notification","FormMultiselect","init","courseSelect","groupSelect","on","updateGroups","val","enhanceMultiselects","selectedCourses","empty","length","call","methodname","args","courseids","map","id","parseInt","done","groups","append","each","index","group","name","coursename","fail","error","exception","prop","html","appendTo","addClass"],"mappings":"AAKAA,2CAAO,CAAC,SAAU,YAAa,sBAAsB,SAASC,EAAGC,KAAMC,kBAE/DC,gBAAkB,CAKlBC,KAAM,eACEC,aAAeL,EAAE,iBACjBM,YAAcN,EAAE,gBAGpBK,aAAaE,GAAG,UAAU,WACtBJ,gBAAgBK,aAAaH,aAAaI,MAAOH,gBAIrDH,gBAAgBO,uBAQpBF,aAAc,SAASG,gBAAiBL,aAEpCA,YAAYM,QAEPD,iBAA8C,IAA3BA,gBAAgBE,OAOxCZ,KAAKa,KAAK,CAAC,CACPC,WAAY,0CACZC,KAAM,CAACC,UAAWN,gBAAgBO,KAAI,SAASC,WAAaC,SAASD,QACrEE,KAAM,SAASC,QACW,IAAlBA,OAAOT,OACPP,YAAYiB,OAAO,yEAGnBvB,EAAEwB,KAAKF,QAAQ,SAASG,MAAOC,OAC3BpB,YAAYiB,OAAO,kBAAoBG,MAAMP,GAAK,KAC9CO,MAAMC,KAAO,KAAOD,MAAME,WAAa,kBAIvDC,KAAM,SAASC,OACX5B,aAAa6B,UAAUD,OACvBxB,YAAYiB,OAAO,uDAtBvBjB,YAAYiB,OAAO,kEA+B3Bb,oBAAqB,WAEjBV,EAAE,WACGgC,KAAK,OAAQ,YACbC,icAYAC,SAAS,QAEdlC,EAAE,+BAA+BmC,SAAS,mCAI3ChC"}