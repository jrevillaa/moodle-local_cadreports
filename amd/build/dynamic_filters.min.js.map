{"version":3,"file":"dynamic_filters.min.js","sources":["../src/dynamic_filters.js"],"sourcesContent":["define(['jquery', 'core/ajax', 'core/notification'], function($, Ajax, Notification) {\n    'use strict';\n\n    var DynamicFilters = {\n        init: function() {\n            this.bindEvents();\n        },\n\n        bindEvents: function() {\n            var self = this;\n\n            // Escuchar cambios en el selector de cursos\n            $('#id_courseid').on('change', function() {\n                var selectedCourses = $(this).val();\n                if (selectedCourses && selectedCourses.length > 0) {\n                    self.updateGroups(selectedCourses);\n                    self.updateUsers(selectedCourses);\n                } else {\n                    self.clearGroups();\n                    self.clearUsers();\n                }\n            });\n        },\n\n        updateGroups: function(courseIds) {\n            var self = this;\n\n            Ajax.call([{\n                methodname: 'local_cadreports_get_course_data',\n                args: {\n                    courseids: courseIds.join(','),\n                    type: 'groups'\n                }\n            }])[0].done(function(data) {\n                self.populateSelect('#id_groupid', data);\n            }).fail(function(error) {\n                Notification.exception(error);\n            });\n        },\n\n        updateUsers: function(courseIds) {\n            var self = this;\n\n            Ajax.call([{\n                methodname: 'local_cadreports_get_course_data',\n                args: {\n                    courseids: courseIds.join(','),\n                    type: 'users'\n                }\n            }])[0].done(function(data) {\n                self.populateSelect('#id_userid', data);\n            }).fail(function(error) {\n                Notification.exception(error);\n            });\n        },\n\n        populateSelect: function(selector, data) {\n            var $select = $(selector);\n            var autocomplete = $select.data('autocomplete');\n\n            if (autocomplete) {\n                // Limpiar opciones actuales\n                autocomplete.clearSelection();\n\n                // Actualizar opciones disponibles\n                autocomplete.processResults(data);\n            }\n        },\n\n        clearGroups: function() {\n            this.populateSelect('#id_groupid', []);\n        },\n\n        clearUsers: function() {\n            this.populateSelect('#id_userid', []);\n        }\n    };\n\n    return DynamicFilters;\n});\n"],"names":["define","$","Ajax","Notification","init","bindEvents","self","this","on","selectedCourses","val","length","updateGroups","updateUsers","clearGroups","clearUsers","courseIds","call","methodname","args","courseids","join","type","done","data","populateSelect","fail","error","exception","selector","autocomplete","clearSelection","processResults"],"mappings":"AAAAA,0CAAO,CAAC,SAAU,YAAa,sBAAsB,SAASC,EAAGC,KAAMC,oBAG9C,CACjBC,KAAM,gBACGC,cAGTA,WAAY,eACJC,KAAOC,KAGXN,EAAE,gBAAgBO,GAAG,UAAU,eACvBC,gBAAkBR,EAAEM,MAAMG,MAC1BD,iBAAmBA,gBAAgBE,OAAS,GAC5CL,KAAKM,aAAaH,iBAClBH,KAAKO,YAAYJ,mBAEjBH,KAAKQ,cACLR,KAAKS,kBAKjBH,aAAc,SAASI,eACfV,KAAOC,KAEXL,KAAKe,KAAK,CAAC,CACPC,WAAY,mCACZC,KAAM,CACFC,UAAWJ,UAAUK,KAAK,KAC1BC,KAAM,aAEV,GAAGC,MAAK,SAASC,MACjBlB,KAAKmB,eAAe,cAAeD,SACpCE,MAAK,SAASC,OACbxB,aAAayB,UAAUD,WAI/Bd,YAAa,SAASG,eACdV,KAAOC,KAEXL,KAAKe,KAAK,CAAC,CACPC,WAAY,mCACZC,KAAM,CACFC,UAAWJ,UAAUK,KAAK,KAC1BC,KAAM,YAEV,GAAGC,MAAK,SAASC,MACjBlB,KAAKmB,eAAe,aAAcD,SACnCE,MAAK,SAASC,OACbxB,aAAayB,UAAUD,WAI/BF,eAAgB,SAASI,SAAUL,UAE3BM,aADU7B,EAAE4B,UACWL,KAAK,gBAE5BM,eAEAA,aAAaC,iBAGbD,aAAaE,eAAeR,QAIpCV,YAAa,gBACJW,eAAe,cAAe,KAGvCV,WAAY,gBACHU,eAAe,aAAc"}