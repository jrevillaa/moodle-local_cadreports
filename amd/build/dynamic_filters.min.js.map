{"version":3,"file":"dynamic_filters.min.js","sources":["../src/dynamic_filters.js"],"sourcesContent":["define(['jquery', 'core/ajax', 'core/notification'], function($, Ajax, Notification) {\n    'use strict';\n\n    var DynamicFilters = {\n\n        init: function() {\n            this.bindEvents();\n        },\n\n        bindEvents: function() {\n            var self = this;\n\n            // Escuchar cambios en el selector de cursos\n            $(document).on('change', '#id_courseid', function() {\n                var selectedCourses = $(this).val();\n                if (selectedCourses && selectedCourses.length > 0) {\n                    self.updateGroups(selectedCourses);\n                    self.updateUsers(selectedCourses);\n                } else {\n                    self.clearSelect('#id_groupid');\n                    self.clearSelect('#id_userid');\n                }\n            });\n        },\n\n        updateGroups: function(courseIds) {\n            var self = this;\n\n            var request = Ajax.call([{\n                methodname: 'local_cadreports_get_course_data',\n                args: {\n                    courseids: courseIds.join(','),\n                    type: 'groups'\n                }\n            }]);\n\n            request[0].done(function(data) {\n                self.populateAutocomplete('#id_groupid', data);\n            }).fail(function(error) {\n                Notification.exception(error);\n            });\n        },\n\n        updateUsers: function(courseIds) {\n            var self = this;\n\n            var request = Ajax.call([{\n                methodname: 'local_cadreports_get_course_data',\n                args: {\n                    courseids: courseIds.join(','),\n                    type: 'users'\n                }\n            }]);\n\n            request[0].done(function(data) {\n                self.populateAutocomplete('#id_userid', data);\n            }).fail(function(error) {\n                Notification.exception(error);\n            });\n        },\n\n        populateAutocomplete: function(selector, data) {\n            var $select = $(selector);\n\n            // Limpiar opciones existentes\n            $select.empty();\n\n            // Agregar opción vacía\n            $select.append($('<option></option>').attr('value', '').text(''));\n\n            // Agregar nuevas opciones\n            $.each(data, function(index, item) {\n                $select.append($('<option></option>').attr('value', item.id).text(item.text));\n            });\n\n            // Reinicializar el autocomplete si existe\n            if ($select.data('select2')) {\n                $select.trigger('change');\n            }\n        },\n\n        clearSelect: function(selector) {\n            var $select = $(selector);\n            $select.empty();\n            $select.append($('<option></option>').attr('value', '').text(''));\n\n            if ($select.data('select2')) {\n                $select.trigger('change');\n            }\n        }\n    };\n\n    return DynamicFilters;\n});\n"],"names":["define","$","Ajax","Notification","init","bindEvents","self","this","document","on","selectedCourses","val","length","updateGroups","updateUsers","clearSelect","courseIds","call","methodname","args","courseids","join","type","done","data","populateAutocomplete","fail","error","exception","selector","$select","empty","append","attr","text","each","index","item","id","trigger"],"mappings":"AAAAA,0CAAO,CAAC,SAAU,YAAa,sBAAsB,SAASC,EAAGC,KAAMC,oBAG9C,CAEjBC,KAAM,gBACGC,cAGTA,WAAY,eACJC,KAAOC,KAGXN,EAAEO,UAAUC,GAAG,SAAU,gBAAgB,eACjCC,gBAAkBT,EAAEM,MAAMI,MAC1BD,iBAAmBA,gBAAgBE,OAAS,GAC5CN,KAAKO,aAAaH,iBAClBJ,KAAKQ,YAAYJ,mBAEjBJ,KAAKS,YAAY,eACjBT,KAAKS,YAAY,mBAK7BF,aAAc,SAASG,eACfV,KAAOC,KAEGL,KAAKe,KAAK,CAAC,CACrBC,WAAY,mCACZC,KAAM,CACFC,UAAWJ,UAAUK,KAAK,KAC1BC,KAAM,aAIN,GAAGC,MAAK,SAASC,MACrBlB,KAAKmB,qBAAqB,cAAeD,SAC1CE,MAAK,SAASC,OACbxB,aAAayB,UAAUD,WAI/Bb,YAAa,SAASE,eACdV,KAAOC,KAEGL,KAAKe,KAAK,CAAC,CACrBC,WAAY,mCACZC,KAAM,CACFC,UAAWJ,UAAUK,KAAK,KAC1BC,KAAM,YAIN,GAAGC,MAAK,SAASC,MACrBlB,KAAKmB,qBAAqB,aAAcD,SACzCE,MAAK,SAASC,OACbxB,aAAayB,UAAUD,WAI/BF,qBAAsB,SAASI,SAAUL,UACjCM,QAAU7B,EAAE4B,UAGhBC,QAAQC,QAGRD,QAAQE,OAAO/B,EAAE,qBAAqBgC,KAAK,QAAS,IAAIC,KAAK,KAG7DjC,EAAEkC,KAAKX,MAAM,SAASY,MAAOC,MACzBP,QAAQE,OAAO/B,EAAE,qBAAqBgC,KAAK,QAASI,KAAKC,IAAIJ,KAAKG,KAAKH,UAIvEJ,QAAQN,KAAK,YACbM,QAAQS,QAAQ,WAIxBxB,YAAa,SAASc,cACdC,QAAU7B,EAAE4B,UAChBC,QAAQC,QACRD,QAAQE,OAAO/B,EAAE,qBAAqBgC,KAAK,QAAS,IAAIC,KAAK,KAEzDJ,QAAQN,KAAK,YACbM,QAAQS,QAAQ"}