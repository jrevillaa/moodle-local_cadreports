{"version":3,"file":"group_loader.min.js","sources":["../src/group_loader.js"],"sourcesContent":["/**\n * AMD module para carga din√°mica de grupos usando AJAX nativo de Moodle\n * Plugin local_cadreports para Moodle 4.4\n */\n\ndefine(['jquery', 'core/ajax', 'core/notification'], function($, Ajax, Notification) {\n\n    var GroupLoader = {\n\n        /**\n         * Inicializar el cargador de grupos\n         */\n        init: function() {\n            $('#id_courseid').on('change', this.loadGroups);\n        },\n\n        /**\n         * Cargar grupos del curso seleccionado usando core/ajax\n         */\n        loadGroups: function() {\n            var courseid = $(this).val();\n            var groupselect = $('#id_groupid');\n\n            // Limpiar opciones actuales\n            groupselect.empty().append('<option value=\"0\">' +\n                M.util.get_string('allgroups', 'local_cadreports') + '</option>');\n\n            if (courseid > 0) {\n                // Usar Ajax.call nativo de Moodle sin almacenar en variable\n                Ajax.call([{\n                    methodname: 'local_cadreports_get_course_groups',\n                    args: {courseid: parseInt(courseid)},\n                    done: function(groups) {\n                        $.each(groups, function(index, group) {\n                            groupselect.append('<option value=\"' + group.id + '\">' +\n                                group.name + '</option>');\n                        });\n                        groupselect.prop('disabled', false);\n                    },\n                    fail: function(error) {\n                        Notification.exception(error);\n                        groupselect.prop('disabled', true);\n                    }\n                }]);\n            } else {\n                groupselect.prop('disabled', true);\n            }\n        }\n    };\n\n    return GroupLoader;\n});\n"],"names":["define","$","Ajax","Notification","init","on","this","loadGroups","courseid","val","groupselect","empty","append","M","util","get_string","call","methodname","args","parseInt","done","groups","each","index","group","id","name","prop","fail","error","exception"],"mappings":"AAKAA,uCAAO,CAAC,SAAU,YAAa,sBAAsB,SAASC,EAAGC,KAAMC,oBAEjD,CAKdC,KAAM,WACFH,EAAE,gBAAgBI,GAAG,SAAUC,KAAKC,aAMxCA,WAAY,eACJC,SAAWP,EAAEK,MAAMG,MACnBC,YAAcT,EAAE,eAGpBS,YAAYC,QAAQC,OAAO,qBACvBC,EAAEC,KAAKC,WAAW,YAAa,oBAAsB,aAErDP,SAAW,EAEXN,KAAKc,KAAK,CAAC,CACPC,WAAY,qCACZC,KAAM,CAACV,SAAUW,SAASX,WAC1BY,KAAM,SAASC,QACXpB,EAAEqB,KAAKD,QAAQ,SAASE,MAAOC,OAC3Bd,YAAYE,OAAO,kBAAoBY,MAAMC,GAAK,KAC9CD,MAAME,KAAO,gBAErBhB,YAAYiB,KAAK,YAAY,IAEjCC,KAAM,SAASC,OACX1B,aAAa2B,UAAUD,OACvBnB,YAAYiB,KAAK,YAAY,OAIrCjB,YAAYiB,KAAK,YAAY"}