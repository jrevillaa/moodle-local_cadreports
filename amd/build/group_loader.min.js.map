{"version":3,"file":"group_loader.min.js","sources":["../src/group_loader.js"],"sourcesContent":["/**\n * AMD module para carga din√°mica de grupos usando AJAX nativo de Moodle\n * Plugin local_cadreports para Moodle 4.4\n */\n\ndefine(['jquery', 'core/ajax', 'core/notification', 'core/str'], function($, Ajax, Notification, Str) {\n\n    var GroupLoader = {\n\n        /**\n         * Inicializar el cargador de grupos\n         */\n        init: function() {\n            $('#id_courseid').on('change', this.loadGroups);\n        },\n\n        /**\n         * Cargar grupos del curso seleccionado usando core/ajax\n         */\n        loadGroups: function() {\n            var courseid = $(this).val();\n            var groupselect = $('#id_groupid');\n\n            // Obtener string usando core/str y luego limpiar opciones\n            Str.get_string('allgroups', 'local_cadreports').then(function(allgroupstext) {\n                groupselect.empty().append('<option value=\"0\">' + allgroupstext + '</option>');\n\n                if (courseid > 0) {\n                    // Usar Ajax.call nativo de Moodle\n                    Ajax.call([{\n                        methodname: 'local_cadreports_get_course_groups',\n                        args: {courseid: parseInt(courseid)},\n                        done: function(groups) {\n                            $.each(groups, function(index, group) {\n                                groupselect.append('<option value=\"' + group.id + '\">' +\n                                    group.name + '</option>');\n                            });\n                            groupselect.prop('disabled', false);\n                        },\n                        fail: function(error) {\n                            Notification.exception(error);\n                            groupselect.prop('disabled', true);\n                        }\n                    }]);\n                } else {\n                    groupselect.prop('disabled', true);\n                }\n            }).catch(function(error) {\n                Notification.exception(error);\n            });\n        }\n    };\n\n    return GroupLoader;\n});\n"],"names":["define","$","Ajax","Notification","Str","init","on","this","loadGroups","courseid","val","groupselect","get_string","then","allgroupstext","empty","append","call","methodname","args","parseInt","done","groups","each","index","group","id","name","prop","fail","error","exception","catch"],"mappings":"AAKAA,uCAAO,CAAC,SAAU,YAAa,oBAAqB,aAAa,SAASC,EAAGC,KAAMC,aAAcC,WAE3E,CAKdC,KAAM,WACFJ,EAAE,gBAAgBK,GAAG,SAAUC,KAAKC,aAMxCA,WAAY,eACJC,SAAWR,EAAEM,MAAMG,MACnBC,YAAcV,EAAE,eAGpBG,IAAIQ,WAAW,YAAa,oBAAoBC,MAAK,SAASC,eAC1DH,YAAYI,QAAQC,OAAO,qBAAuBF,cAAgB,aAE9DL,SAAW,EAEXP,KAAKe,KAAK,CAAC,CACPC,WAAY,qCACZC,KAAM,CAACV,SAAUW,SAASX,WAC1BY,KAAM,SAASC,QACXrB,EAAEsB,KAAKD,QAAQ,SAASE,MAAOC,OAC3Bd,YAAYK,OAAO,kBAAoBS,MAAMC,GAAK,KAC9CD,MAAME,KAAO,gBAErBhB,YAAYiB,KAAK,YAAY,IAEjCC,KAAM,SAASC,OACX3B,aAAa4B,UAAUD,OACvBnB,YAAYiB,KAAK,YAAY,OAIrCjB,YAAYiB,KAAK,YAAY,MAElCI,OAAM,SAASF,OACd3B,aAAa4B,UAAUD"}